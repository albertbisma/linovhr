<app-topnav></app-topnav> 
<section id="team" class="pb-5">
  
    <div class="container-fluid">        
      <!-- MODAL -->      
      
      <!-- Modal -->

      <p-growl [value]="msgs"></p-growl>
    
      <p-confirmDialog></p-confirmDialog>
      
      <div class="modal fade" id="createModal" tabindex="-1" role="dialog" aria-labelledby="modelTitleId" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title">Add Detail Task</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            <div class="modal-body">
              <div class="container-fluid align-content-center">                              
                
                <form [formGroup]="formDtl" (ngSubmit)="onFormSubmitDtl()">                  
                   
                    <div>
                      <label for="user">Task Name </label>
                    </div>

                    <div formGroupName="task">
                        <select name="user" formControlName="idTask">
                            <option value="">-- Select Task Type --</option>
                            <option *ngFor="let tasktype of tasktypes" value="{{tasktype.idTask}}">{{tasktype.jenisTask}}</option>                             
                          </select>
                    </div>

                    <div>
                      <label for="startdate">Start Date </label>
                    </div>

                    <div>
                      <input type="date" class="form-control" formControlName="tglAwal" name="startdate" id="inputstartdate"> 
                    </div>
                    
                    <div>
                      <label for="finishdate">Estimate Finish Date </label>
                    </div>

                    <div>
                      <input name="finishdate" type="date" class="form-control" formControlName="tglAkhir" id="inputestimatedata"> 
                    </div>

                    <div>
                      <label for="description">Description </label>
                    </div>

                    <div>
                      <textarea class="form-control" name="description" formControlName="keterangan" id="txtareadesc" cols="30" rows="5"></textarea>
                    </div>

                    <div class="modal-footer">              
                        <button type="submit" class="btn btn-primary">Save</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                      </div>
                </form>                                                
              </div>
            </div>
            
          </div>
        </div>
      </div>
      
      <script>
        $('#exampleModal').on('show.bs.modal', event => {
          var button = $(event.relatedTarget);
          var modal = $(this);
          // Use above variables to manipulate the DOM
          
        });
      </script>

      



      <div class="alert alert-danger" role="alert" style="display:none;"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
        data failed to create! please check your input!
        </div>
      <div class="alert alert-success" role="alert" style="display:none;"><i class="fa fa-check" aria-hidden="true"></i>
        data successfully created!
        </div>
        
      <h1>Create New Task</h1>
      <form [formGroup]="formHdr" (ngSubmit)="onFormSubmitHdr()" class="justify-content-center">
        <div class="form-group row">
        <div class="col-sm-1" align="right">
          <label for="taskcode">Task Code</label>            
        </div>
  
        <div class="col-sm-2">
          <input type="text" formControlName="kodeTask" class="form-control" id="taskcode">
          <br>
        </div>
           
        
        <div class="col-sm-7" align="right">
          <label for="User Type">Payroll Specialist Name</label>
        </div>
  
        <div formGroupName="payrollSpecialist" class="col-sm-2">
          <select formControlName="idPs" id="month" name="month">
            <option value="">-- Select Payroll --</option>                      
            <option *ngFor="let ps of listps" value="{{ps.idPs}}">{{ps.nama}}</option>
          </select>              
          <br>
        </div>
        

        <div class="col-sm-1" align="right">
            <label for="taskcode">Period</label>            
        </div>                                               
          
        <div class="col-sm-2">
            <select formControlName="bulan" id="month" name="month">
              <option value="">-- Select Month --</option>                      
              <option *ngFor="let enum of listenum" value="{{enum}}">{{enum}}</option>
            </select>              

            <select formControlName="tahun" id="year" name="year">
                <option value="">-- Select Year --</option>
                <option value="2018">2018</option>
                <option value="2019">2019</option>
                <option value="2020">2020</option>
                <option value="2021">2021</option>
                <option value="2022">2022</option>
                <option value="2020">2023</option>
                <option value="2024">2024</option>
                <option value="2025">2025</option>
                <option value="2026">2026</option>
                <option value="2027">2027</option>
                <option value="2028">2028</option>
                <option value="2029">2029</option>
                <option value="2030">2030</option>
              </select>              
            <br>
        </div>

              <div class="col-sm-7" align="right">
                  <label for="taskcode">Client</label>            
                </div>           
                                
                  <div formGroupName="client" class="col-sm-2" style="display:block">
                    <select formControlName="idClient" id="client" name="client">
                      <option value="">-- Select Client --</option>
                      <option *ngFor="let client of clients" value="{{client.idClient}}">{{client.nama}}</option>
                    </select>              
                  </div>        

  
                  <div class="col-sm-7" align="right">
                      <button type="submit" class="btn btn-primary">Submit</button>   
                      <button type="submit" class="btn btn-primary" [routerLink]="['/task']">Cancel</button>
                  </div>        

                  <br><br><br>
                  <div class="col-sm-5"></div>
                       
                  <div>
                      <button type="submit" class="btn btn-primary" (click)="getData()" data-toggle="modal" data-target="#createModal"><i class="fa fa-plus-circle" aria-hidden="true"></i> Add Detail</button>
                  </div>
                
                <div class="table-responsive">
                  <table class="table table-bordered">
                      <thead>
                        <tr class="table-primary">
                          <th>#</th>
                          <th>Task Name</th>
                          <th>Start Date</th>
                          <th>Estimate Finish Date</th>
                          <th>Description</th>
                          <th>Finish At</th>
                          <th>Note Final</th>
                          <th>Status Task</th>
                          <th style="text-align:center">Action</th>                    
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let taskDtl of tableTaskDtl; let i = index">
                          <td>{{i+1}}</td>
                          <td>{{taskDtl.task.idTask}}</td>
                          <td>{{taskDtl.tglAwal}}</td>                                        
                          <td>{{taskDtl.tglAkhir}}</td>
                          <td>{{taskDtl.keterangan}}</td>
                          <td>-</td>
                          <td>-</td>
                          <td>Pending</td>
                          <td style="text-align:center">
                            <button type="button" class="btn btn-success btn-circle btn-lg" routerLink="/taskform"><i class="fa fa-check"></i></button>
                            <button type="button" class="btn btn-primary btn-circle btn-lg" routerLink="/taskform"><i class="fa fa-pencil"></i></button>
                            <button type="button" (click)="confirmDelete(i, taskDtl.keterangan)" class="btn btn-danger btn-circle btn-lg"><i class="fa fa-trash"></i></button>
                          </td>
                        </tr>           
                                                 
                      </tbody>
                    </table>
                  </div>

              
    <!--      
        <div class="col-sm-4">
          <input type="text" class="form-control" id="usertype" placeholder="Input user type here" required>
        </div>             -->
        </div>                 
     </form>           
    </div>
    </section>
    
    
    